#include <stdio.h>

cps int
square(int n)
{
    return (n*n);
}

cps void
g(char c)
{
    int i;

    cps void
    f(void)
    {
        printf("%c: %d^2=%d\n", c, i, square(i));
        return;
    }

    for(i = 0; i < 10; i++) {
        cpc_yield;
        f();
        if(i % 2 == 0)
            f();
        f();
    }
}


int
main()
{
    cpc_spawn { g('a'); printf("A a fini, B devrait bientot.\n"); }
    cpc_spawn { g('b'); }
    cpc_main_loop();
    return 0;
}

